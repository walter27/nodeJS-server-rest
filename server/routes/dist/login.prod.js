"use strict";var express=require("express"),app=express(),Usuario=require("../models/usuario"),bcrypt=require("bcrypt"),jwt=require("jsonwebtoken");app.post("/login",function(r,o){var a=r.body;Usuario.findOne({email:a.email},function(r,s){if(r)return o.status(500).json({ok:!1,err:r});if(!s)return o.status(400).json({ok:!1,err:{message:"(Usuario) o contraseña incorretos"}});if(!bcrypt.compareSync(a.password,s.password))return o.status(400).json({ok:!1,err:{message:"Usuario o (contraseña) incorretos"}});var e=jwt.sign({usuario:s},process.env.SEED,{expiresIn:process.env.CADUCIDAD_TOKEN});o.json({ok:!0,usuario:s,token:e})})}),module.exports=app;