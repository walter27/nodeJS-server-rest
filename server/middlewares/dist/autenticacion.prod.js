"use strict";var jwt=require("jsonwebtoken"),verficaToken=function(r,i,n){var e=r.get("token");jwt.verify(e,process.env.SEED,function(e,o){if(e)return i.status(401).json({ok:!1,err:{message:"token no valido"}});r.usuario=o.usuario,n()})},verificaRol=function(e,o,r){var i=e.usuario;if(console.log(i.role),"ADMIN_ROLE"!==i.role)return o.json({ok:!1,err:{message:"El usuario no es administrador"}});r()};module.exports={verficaToken:verficaToken,verificaRol:verificaRol};